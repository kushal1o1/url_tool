{% extends 'base.html' %}
{%block tittle%}Url Tool{%endblock%}
{% block mainContent%}
<section class="container section  flex ">
  <form id="urlForm"  class="container">
    {% csrf_token %}

    <input type="text" name="url" id="url_link" placeholder="Enter Your Url">

    <button type="submit" class="button" id="shorten">Check</button>

  </form>
</section>



  <div id="link_info" class="link_div container   ">
    <p id="result" ></p>
  </div>  




<script>
  document.getElementById('urlForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const formData = new FormData(this);
      fetch('', {
          method: 'POST',
          body: formData
      })
      .then(response => response.json())
      .then(data => {
          const link_infoDiv = document.getElementById('link_info');
          link_infoDiv.style.display ="block";
          const resultDiv = document.getElementById('result');
          resultDiv.innerHTML = `<p>Status: <span class="shortlink">${data.status}</span></p>
          <p>Status Message:<span class="shortlink">${data.message}</span> </p>`;
          if (data.initial_url) {
              resultDiv.innerHTML += `<p>Initial URL:<span class="shortlink"> ${data.initial_url}</span></p>`;
          }
          if (data.final_url) {
              resultDiv.innerHTML += `<p>Final URL:<span class="shortlink">${data.final_url}</span> </p>`;
          }
          if (data.status_code) {
              resultDiv.innerHTML += `<p>Status Code:<span class="shortlink" ${data.status_code}</span></p>`;
          }
          if (data.redirects) {
              resultDiv.innerHTML += `<p>Number of Redirects:<span class="shortlink"> ${data.redirects}</span></p>`;
          }
          if (data.vt_message) {
              resultDiv.innerHTML += `<p>Message: <span class="shortlink">${data.vt_message}</span></p>`;
          }
      });
  });
</script>
<br>

{%endblock%}